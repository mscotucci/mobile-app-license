<page-body>
    <page-header header>
        <span title>Dettaglio Cliente</span>
    </page-header>

    <div class="grid grid-cols-1 gap-8 w-full mt-8" body>
        <!-- Form -->
        <form [formGroup]="formGroup">
            <!-- Customer details -->
            <div
                class="flex flex-wrap w-full max-w-screen-xl mx-auto p-6 md:p-8"
            >
                <div class="grid xl:grid-cols-3 grid-cols-1 gap-6 w-full">
                    <div class="p-6 bg-card shadow rounded-2xl overflow-hidden">
                        <div class="flex p-2">
                            <!-- description -->
                            <mat-form-field
                                class="fuse-mat-no-subscript flex-auto"
                            >
                                <mat-label>Descrizione</mat-label>
                                <mat-icon
                                    class="icon-size-5"
                                    [svgIcon]="'heroicons_solid:user'"
                                    matPrefix
                                ></mat-icon>
                                <input
                                    [formControlName]="'description'"
                                    matInput
                                />
                                <mat-error>
                                    Descrizione obbligatoria
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="p-6 bg-card shadow rounded-2xl overflow-hidden">
                        <!-- AppConfigurations -->
                        <div
                            class="flex flex-col p-2"
                            formGroupName="appConfigurations"
                        >
                            <!--apiKey-->
                            <mat-form-field
                                class="fuse-mat-no-subscript flex-auto"
                            >
                                <mat-label>Api Key Tomtom</mat-label>
                                <mat-icon
                                    matPrefix
                                    class="hidden sm:flex icon-size-5"
                                    [svgIcon]="'heroicons_solid:key'"
                                ></mat-icon>
                                <input
                                    matInput
                                    [formControlName]="'apiKey'"
                                    [placeholder]="'Api key account tomtom'"
                                    [spellcheck]="false"
                                />
                                <mat-error>
                                    Api Key Tomtom obbligatoria
                                </mat-error>
                            </mat-form-field>
                            <!-- apiAccount -->
                            <div class="mt-4">
                                <mat-form-field
                                    class="fuse-mat-no-subscript w-full"
                                >
                                    <mat-label>Api Account Tomtom</mat-label>
                                    <mat-icon
                                        matPrefix
                                        class="hidden sm:flex icon-size-5"
                                        [svgIcon]="'hourglass_top'"
                                    ></mat-icon>
                                    <input
                                        matInput
                                        [formControlName]="'apiAccount'"
                                        [placeholder]="
                                            'Username account tomtom'
                                        "
                                        [spellcheck]="false"
                                    />
                                    <mat-error>
                                        Api Key Tomtom obbligatoria
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <!-- apiAccountPassword -->
                            <div class="mt-4">
                                <mat-form-field
                                    class="fuse-mat-no-subscript w-full"
                                >
                                    <mat-label>Password Cliente</mat-label>
                                    <input
                                        id="password"
                                        matInput
                                        type="password"
                                        [formControlName]="'apiAccountPassword'"
                                        #passwordField
                                    />
                                    <button
                                        mat-icon-button
                                        type="button"
                                        (click)="
                                            passwordField.type === 'password'
                                                ? (passwordField.type = 'text')
                                                : (passwordField.type =
                                                      'password')
                                        "
                                        matSuffix
                                    >
                                        <mat-icon
                                            class="icon-size-5"
                                            *ngIf="
                                                passwordField.type ===
                                                'password'
                                            "
                                            [svgIcon]="'heroicons_solid:eye'"
                                        ></mat-icon>
                                        <mat-icon
                                            class="icon-size-5"
                                            *ngIf="
                                                passwordField.type === 'text'
                                            "
                                            [svgIcon]="
                                                'heroicons_solid:eye-off'
                                            "
                                        ></mat-icon>
                                    </button>
                                    <mat-error> Password Cliente </mat-error>
                                </mat-form-field>
                            </div>
                            <!-- markerStopDurationInMinute -->
                            <div class="mt-4">
                                <mat-form-field
                                    class="fuse-mat-no-subscript w-full"
                                >
                                    <mat-label
                                        >Marker Stop Duration In
                                        Minute</mat-label
                                    >
                                    <mat-icon
                                        matPrefix
                                        class="hidden sm:flex icon-size-5"
                                        [svgIcon]="'hourglass_top'"
                                    ></mat-icon>
                                    <input
                                        matInput
                                        [formControlName]="
                                            'markerStopDurationInMinute'
                                        "
                                        [placeholder]="
                                            'Minuti dopo i quali segnalare uno stop'
                                        "
                                        [spellcheck]="false"
                                    />
                                    <mat-error>
                                        Api Key Tomtom obbligatoria
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="p-6 bg-card shadow rounded-2xl overflow-hidden">
                        <!-- License items -->
                        <div class="flex flex-col p-2" formGroupName="license">
                            <!--MaxDevices-->
                            <mat-form-field
                                class="fuse-mat-no-subscript flex-auto"
                            >
                                <mat-label>Max Device</mat-label>
                                <mat-icon
                                    matPrefix
                                    class="hidden sm:flex icon-size-5"
                                    [svgIcon]="'heroicons_solid:device-mobile'"
                                ></mat-icon>
                                <input
                                    matInput
                                    [formControlName]="'maxDevices'"
                                    [placeholder]="'Numero Max Dispositivi'"
                                    [spellcheck]="false"
                                />
                            </mat-form-field>
                            <!-- expireDate -->
                            <div class="mt-4">
                                <mat-form-field
                                    class="fuse-mat-no-subscript w-full"
                                >
                                    <mat-label>Scadenza Licenza</mat-label>
                                    <mat-icon
                                        matPrefix
                                        class="hidden sm:flex icon-size-5"
                                        [svgIcon]="'hourglass_top'"
                                    ></mat-icon>
                                    <input
                                        matInput
                                        [matDatepicker]="expireDate"
                                        [formControlName]="'expireDate'"
                                        [placeholder]="'Data Scadenza Licenza'"
                                    />
                                    <mat-datepicker-toggle
                                        matSuffix
                                        [for]="expireDate"
                                    >
                                    </mat-datepicker-toggle>
                                    <mat-datepicker
                                        #expireDate
                                    ></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <!-- expireDate -->
                            <div class="mt-4">
                                <mat-form-field
                                    class="fuse-mat-no-subscript w-full"
                                >
                                    <mat-label>License Key</mat-label>
                                    <mat-icon
                                        matPrefix
                                        class="hidden sm:flex icon-size-5"
                                        [svgIcon]="'heroicons_solid:key'"
                                    ></mat-icon>
                                    <input
                                        matInput
                                        [formControlName]="'code'"
                                        [placeholder]="'License Key'"
                                        [spellcheck]="false"
                                        readonly
                                    />
                                </mat-form-field>
                            </div>
                        </div>

                        <!-- Devices -->
                        <ng-container
                            *ngFor="
                                let device of devices;
                                let i = index;
                                let first = first;
                                let last = last;
                                trackBy: trackByFn
                            "
                        >
                            <div class="flex p-2">
                                <mat-form-field
                                    class="fuse-mat-no-subscript flex-auto"
                                >
                                    <mat-label *ngIf="first">Device</mat-label>
                                    <mat-icon
                                        matPrefix
                                        class="hidden sm:flex icon-size-5"
                                        [svgIcon]="
                                            'heroicons_solid:device-mobile'
                                        "
                                    ></mat-icon>
                                    <input
                                        matInput
                                        [value]="device"
                                        [placeholder]="'Device'"
                                        [spellcheck]="false"
                                    />
                                </mat-form-field>
                                <!-- Remove license -->
                                <ng-container>
                                    <div
                                        class="flex items-center w-10 pl-2"
                                        [ngClass]="{ 'mt-6': first }"
                                    >
                                        <button
                                            class="w-8 h-8 min-h-8"
                                            mat-icon-button
                                            (click)="removeEmailField(device)"
                                            matTooltip="Remove"
                                        >
                                            <mat-icon
                                                class="icon-size-5"
                                                [svgIcon]="
                                                    'heroicons_solid:trash'
                                                "
                                            ></mat-icon>
                                        </button>
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <!-- Divider -->
            <div class="mt-11 mb-10 border-t"></div>

            <!-- Actions -->
            <div class="flex items-center justify-end">
                <button mat-stroked-button type="button" [routerLink]="['/']">
                    Annulla
                </button>
                <button
                    class="ml-4"
                    mat-flat-button
                    type="button"
                    [disabled]="!formGroup.valid"
                    [color]="'primary'"
                    (click)="saveCustomer()"
                >
                    Salva
                </button>
            </div>
        </form>
    </div>
</page-body>
